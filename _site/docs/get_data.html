<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>How to Get Data on CUBIC</title>
<meta name="description" content="Get Data">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="AI2D | PennLINC | Shared Data Resources">
<meta property="og:title" content="How to Get Data on CUBIC">
<meta property="og:url" content="http://localhost:4000/AI2D/docs/get_data">


  <meta property="og:description" content="Get Data">











  

  


<link rel="canonical" href="http://localhost:4000/AI2D/docs/get_data">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "AI2D",
      "url": "http://localhost:4000/AI2D/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/AI2D/feed.xml" type="application/atom+xml" rel="alternate" title="AI2D | PennLINC | Shared Data Resources Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="/AI2D/assets/css/main.css">
<link rel="stylesheet" href="/AI2D/assets/css/custom.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
<!-- Fonts via Google -->
<link href="https://fonts.googleapis.com/css?family=Lato:300italic,700italic,300,700" rel="stylesheet" type="text/css"/>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top" role="navigation">
    <div class="container d-flex justify-content-between">
        <a class="navbar-brand" href="/AI2D/">
            
                <a class="site-logo" href="/AI2D/"><img src="/AI2D/assets/images/logos/ai2d_pennlinc_logo.png" alt="AI2D | PennLINC | Shared Data Resources"></a>
            
        </a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggler" aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarToggler">
            <ul class="navbar-nav ml-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="/AI2D/docs/datasets">Datasets</a>
                        </li>
                    
                
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" id="navbarDropdown-Imaging" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Imaging
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown-Imaging">
                                
                                    <a class="nav-link dropdown-item" href="/AI2D/docs/imaging/image_curation">Data Curation: CuBIDS</a>
                                
                                    <a class="nav-link dropdown-item" href="/AI2D/docs/imaging/image_babs">Data Processing: BABS</a>
                                
                                    <a class="nav-link dropdown-item" href="/AI2D/docs/imaging/image_smriprep">sMRIPrep</a>
                                
                                    <a class="nav-link dropdown-item" href="/AI2D/docs/imaging/image_fmriprep">fMRIPrep</a>
                                
                                    <a class="nav-link dropdown-item" href="/AI2D/docs/imaging/image_xcpd">XCP-D</a>
                                
                                    <a class="nav-link dropdown-item" href="/AI2D/docs/imaging/image_qsiprep">QSIPrep</a>
                                
                                    <a class="nav-link dropdown-item" href="/AI2D/docs/imaging/image_qsirecon">QSIRecon</a>
                                
                            </div>
                        </li>
                    
                
                        <li class="nav-item">
                            <a class="nav-link" href="/AI2D/docs/team">Team</a>
                        </li>
                    
                
                        <li class="nav-item">
                            <a class="nav-link" href="/AI2D/docs/blog/index">News</a>
                        </li>
                    
                
                        <li class="nav-item">
                            <a class="nav-link" href="/AI2D/docs/get_data"><em style="font-style:normal; font-weight:bold; color:#a594d1;"> Get Data </em></a>
                        </li>
                    
                
            </ul>
        </div>
    </div>
</nav>


    <div class="initial-content">
      




<div id="main" role="main">
  

  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="How to Get Data on CUBIC">
    <meta itemprop="description" content="Get Data">
    
    

    <div class="page__inner-wrap">
      
        <header>
          <br/><h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/AI2D/docs/get_data" class="u-url" itemprop="url">How to Get Data on CUBIC
</a>
          </h1>
          
          <!--


-->
        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <p>The following instruction are intended specifically to get data on CUBIC.</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ol>
  <li><a href="#1-request-access-to-a-cubic-project">Request access to a CUBIC project</a></li>
  <li><a href="#2-dataset-processed-without-babs">Dataset processed without BABS</a></li>
  <li><a href="#3-dataset-processed-with-babs">Dataset processed with BABS</a>
    <ul>
      <li>3.1. <a href="#31-get-data-without-datalad">Get data without DataLad</a>
        <ul>
          <li><a href="#311-prerequisites">Prerequisites</a></li>
          <li><a href="#312-explore-the-data-structure">Explore the Data Structure</a></li>
          <li><a href="#313-extract-specific-data">Extract Specific Data</a></li>
        </ul>
      </li>
      <li>3.2. <a href="#32-get-data-with-datalad">Get data with DataLad</a>
        <ul>
          <li><a href="#321-prerequisites">Prerequisites</a></li>
          <li><a href="#322-example-walkthrough">Example walkthrough</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="1-request-access-to-a-cubic-project">1. Request access to a CUBIC project</h2>

<p>Check the <code class="language-plaintext highlighter-rouge">CUBIC Project</code> section on the Dataset Page to determine which CUBIC project you need to request access to for the dataset of interest (<a href="/AI2D/docs/datasets">list of available datasets</a>).</p>

<p>Follow these steps:</p>

<ol>
  <li>Send Dr. Satterthwaite a request including the following:
    <ul>
      <li>The level of access, in this case, you will need <strong>read-only access</strong></li>
      <li>The name of the user[s] to be given access (full name or login name). If you plan to store and analyze data in a CUBIC project, you should use <strong>your project username</strong>, not personal CUBIC username.</li>
      <li>The full path to the project you need access to. You can find the project path for each study <a href="/AI2D/docs/datasets/">here</a>.</li>
    </ul>
  </li>
  <li>Submit the approval from Dr. Satterthwaite — including the specified user name, project name, and type of access — as a PDF printout to <span style="color: blue;">help@cbica.upenn.edu</span>.</li>
</ol>

<h4 id="check-the-dua-section-on-the-dataset-page-to-determine-whether-the-dataset-you-are-interested-in-is-open-access-see-example-ccnp"><span style="color: #7556b7;">Check the <code class="language-plaintext highlighter-rouge">DUA</code> section on the Dataset Page to determine whether the dataset you are interested in is open access (see example: <a href="/AI2D/docs/datasets/dCCNP/#dataset-summary">CCNP</a>).</span></h4>

<p>If the dataset is NOT open-access,</p>

<h4 id="check-whether-the-dataset-you-are-interested-in-was-processed-with-babs-or-not-see-example-ccnp"><span style="color: #7556b7;">Check whether the dataset you are interested in was processed with <a href="/AI2D/docs/imaging/image_babs">BABS</a> or not (see example: <a href="/AI2D/docs/datasets/dCCNP/#dataset-summary">CCNP</a>).</span></h4>

<h2 id="2-dataset-processed-without-babs">2. Dataset processed without BABS</h2>

<p>If the dataset was NOT processed with BABS, you can copy the data as follows:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cp</span> <span class="nt">-r</span> /path/to/datasets /path/to/your/project
</code></pre></div></div>

<h2 id="3-dataset-processed-with-babs">3. Dataset processed with BABS</h2>

<p>If the dataset WAS processed with BABS, you can get the data either <a href="#32-get-data-with-datalad">using <code class="language-plaintext highlighter-rouge">datalad</code></a> or <a href="#31-get-data-without-datalad">without it</a>, as follows.</p>

<h3 id="31-get-data-without-datalad">3.1. Get data without DataLad</h3>

<p>Outputs from our processing pipelines were most of the time zipped to save inodes.</p>

<p>This section provides instructions in case you prefer NOT to use DataLad and instead want to unzip the output files directly into your CUBIC project directory.</p>

<p><strong>Pros:</strong></p>
<ul>
  <li>Simple and requires no additional software</li>
  <li>Lightweight — you extract only the files you need</li>
</ul>

<p><strong>Cons:</strong></p>
<ul>
  <li>Does not support data provenance tracking</li>
</ul>

<h3 id="311-prerequisites">3.1.1. Prerequisites</h3>

<p><strong>Know the path to the dataset’s ephemeral clones:</strong> see example <a href="/AI2D/docs/datasets/dCCNP/#data-access">CCNP</a></p>

<p><strong>Download the extraction script:</strong> <a href="/AI2D/scripts/unzip_files.sh">unzip_files.sh</a>. The script supports:</p>
<ul>
  <li>Extracting all files from zip archives</li>
  <li>Filtering by subject list (text file with subject IDs)</li>
  <li>Extracting specific file patterns using regex</li>
  <li>Combining subject lists with file patterns</li>
</ul>

<p>For usage instructions, run the script with the <code class="language-plaintext highlighter-rouge">-h</code> or <code class="language-plaintext highlighter-rouge">--help</code> flag.</p>

<h3 id="312-explore-the-data-structure">3.1.2. Explore the Data Structure</h3>

<p>Before extracting data, it’s helpful to understand what files are included in the zip file. You can either:</p>

<p><strong>Option A: Extract a sample participant’s data</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a single subject list file (e.g., one exemplar subject)</span>
<span class="nb">echo</span> <span class="s2">"sub-100307"</span> <span class="o">&gt;</span> single_subject.txt

<span class="nv">input_dir</span><span class="o">=</span>/path/to/ephemeral/clone
<span class="nv">output_dir</span><span class="o">=</span>/path/to/your/cubic/project

bash unzip_files.sh <span class="k">${</span><span class="nv">input_dir</span><span class="k">}</span> <span class="k">${</span><span class="nv">output_dir</span><span class="k">}</span> single_subject.txt
</code></pre></div></div>

<p><strong>Option B: List contents of a zip file</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># XCP-D example</span>
<span class="nv">input_dir</span><span class="o">=</span>/path/to/ephemeral/clone
7z l <span class="k">${</span><span class="nv">input_dir</span><span class="k">}</span>/&lt;subject_id&gt;<span class="k">*</span>.zip
</code></pre></div></div>

<h3 id="313-extract-specific-data">3.1.3. Extract Specific Data</h3>

<p>Once you understand the data structure, you can extract exactly what you need:</p>

<p><strong>Extract specific files for selected subjects:</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># XCP-D example</span>
<span class="nv">input_dir</span><span class="o">=</span>/path/to/ephemeral/clone
<span class="nv">output_dir</span><span class="o">=</span>/path/to/your/cubic/project
<span class="nv">file_pattern</span><span class="o">=</span><span class="s2">"xcpd*/sub-*/func/sub-*_task-rest*space-fsLR_seg-Glasser_stat-pearsoncorrelation_relmat.tsv"</span>

bash unzip_files.sh <span class="k">${</span><span class="nv">input_dir</span><span class="k">}</span> <span class="k">${</span><span class="nv">output_dir</span><span class="k">}</span> subject_list.txt <span class="s2">"</span><span class="k">${</span><span class="nv">file_pattern</span><span class="k">}</span><span class="s2">"</span>

</code></pre></div></div>

<p><strong>Extract specific files for all available subjects:</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Omit the subject list to process all subjects</span>
bash unzip_files.sh <span class="k">${</span><span class="nv">input_dir</span><span class="k">}</span> <span class="k">${</span><span class="nv">output_dir</span><span class="k">}</span> <span class="s2">"</span><span class="k">${</span><span class="nv">file_pattern</span><span class="k">}</span><span class="s2">"</span>
</code></pre></div></div>

<h3 id="32-get-data-with-datalad">3.2. Get data with DataLad</h3>

<p>This section provides instructions in case you prefer to use DataLad.</p>

<p><strong>Pros:</strong></p>
<ul>
  <li>Full data provenance tracking</li>
</ul>

<p><strong>Cons:</strong></p>
<ul>
  <li>Some knowledge of <code class="language-plaintext highlighter-rouge">datalad</code>, <code class="language-plaintext highlighter-rouge">git</code>, <code class="language-plaintext highlighter-rouge">git annex</code></li>
</ul>

<h3 id="321-prerequisites">3.2.1. Prerequisites</h3>

<p><strong>Know the path to the datalad datasets:</strong> see example <a href="/AI2D/docs/datasets/dCCNP/#data-access">CCNP</a></p>

<p><strong>Install DataLad</strong></p>

<p>Follow the instructions <a href="https://www.datalad.org/#install">here</a> to get <code class="language-plaintext highlighter-rouge">datalad</code> installed.</p>

<p>Accessing AI2D data via DataLad happens in two steps. You will first <code class="language-plaintext highlighter-rouge">clone</code> a AI2D data repository. This will make a copy of the AI2D file layout, but none of the actual data will be present. The next step is to <code class="language-plaintext highlighter-rouge">get</code> your data, which tells DataLad to download the content of specific files to your copy. Once the file content is present in your copy, you can use AI2D data just like any other set of files.</p>

<h3 id="322-example-walkthrough">3.2.2. Example walkthrough</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>datalad clone <span class="se">\</span>
    ria+file:///cbica/projects/pennlinc_rbc/datasets/LINC_CCNP/derivatives/xcpd-0-10-6-babs/output_ria#~data <span class="se">\</span>
    ccnp_xcpd

<span class="o">[</span>INFO   <span class="o">]</span> Configure additional publication dependency on <span class="s2">"output-storage"</span>                                                                           
configure-sibling<span class="o">(</span>ok<span class="o">)</span>: <span class="nb">.</span> <span class="o">(</span>sibling<span class="o">)</span>
<span class="nb">install</span><span class="o">(</span>ok<span class="o">)</span>: /cbica/projects/pennlinc_rbc/ccnp_xcpd <span class="o">(</span>dataset<span class="o">)</span>
action summary:
  configure-sibling <span class="o">(</span>ok: 1<span class="o">)</span>
  <span class="nb">install</span> <span class="o">(</span>ok: 1<span class="o">)</span>

<span class="nv">$ </span><span class="nb">cd </span>ccnp_xcpd
<span class="nv">$ </span>datalad get sub-colornest001_ses-1_xcpd-0-10-6.zip
get<span class="o">(</span>ok<span class="o">)</span>: sub-colornest001_ses-1_xcpd-0-10-6.zip <span class="o">(</span>file<span class="o">)</span> <span class="o">[</span>from output-storage...]

<span class="nv">$ </span>datalad drop sub-colornest001_ses-1_xcpd-0-10-6.zip
drop<span class="o">(</span>ok<span class="o">)</span>: sub-colornest001_ses-1_xcpd-0-10-6.zip <span class="o">(</span>file<span class="o">)</span>  
</code></pre></div></div>

<div class="alert alert-primary" role="alert">
  <b>WARNING:</b> These studies take up a lot of disk space. If you attempt to `get` all the file content, you will likely run out of space unless you have a very large storage.
</div>

        
      </section>

      <footer class="page__meta">
        
        <!--

-->
        <!--
-->
      </footer>

      

      <!---->
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<div class="page__footer fixed-bottom">
  <div class="container">
      <div class="row">
          <div class="col-12 text-right">
              <a href="/AI2D/docs/community/get_support/">Get Support</a>
          </div>
      </div>
  </div>
</div>

      </footer>
    </div>

    
  <script src="/AI2D/assets/js/main.min.js"></script>










  </body>
</html>
