{% comment %}
Shared CSS/JS for the copy-to-clipboard widgets used on dataset pages.
{% endcomment %}

<style>
.copy-container { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
.copy-text { flex: 1; word-break: break-all; }
.copy-button {
  background-color: rgb(108, 110, 220);
  color: white;
  border: none;
  padding: 4px 8px;
  border-radius: 3px;
  cursor: pointer;
  font-size: 18px;
  white-space: nowrap;
  flex-shrink: 0;
}
.copy-button:hover { background-color: rgb(104, 106, 235); }
.copy-button:active { background-color: rgb(84, 86, 215); }

/* Tab styles */
.tab-container {
  width: 100%;
}
.tab-buttons {
  display: flex;
  gap: 2px;
  margin-bottom: 5px;
}
.tab-button {
  padding: 6px 12px;
  background-color: #f0f0f0;
  border: 1px solid #ddd;
  border-bottom: none;
  cursor: pointer;
  font-size: 16px;
  border-radius: 3px 3px 0 0;
  transition: background-color 0.2s;
}
.tab-button:hover {
  background-color: #e0e0e0;
}
.tab-button.active {
  background-color: rgb(108, 110, 220);
  color: white;
  border-color: rgb(108, 110, 220);
}
.tab-content {
  display: none;
  padding: 5px;
  background-color: #f9f9f9;
  border: 1px solid #ddd;
  word-break: break-all;
}
.tab-content.active {
  display: block;
}
</style>

<script>
function showTab(tabName) {
  // Find the tab container that contains this tab
  var targetTab = document.getElementById(tabName);
  if (!targetTab) return;
  
  var tabContainer = targetTab.closest('.tab-container');
  if (!tabContainer) return;
  
  // Hide all tab contents within this container
  var tabContents = tabContainer.querySelectorAll('.tab-content');
  for (var i = 0; i < tabContents.length; i++) {
    tabContents[i].classList.remove('active');
  }
  
  // Remove active class from all tab buttons within this container
  var tabButtons = tabContainer.querySelectorAll('.tab-button');
  for (var i = 0; i < tabButtons.length; i++) {
    tabButtons[i].classList.remove('active');
  }
  
  // Show the clicked tab content
  targetTab.classList.add('active');
  
  // Activate the clicked button
  var clickedButton = event.target;
  if (clickedButton && clickedButton.classList.contains('tab-button')) {
    clickedButton.classList.add('active');
  }
}

function copyToClipboard(elementId) {
  var element = document.getElementById(elementId);
  if (!element) return;
  
  // Find the actual text element to copy from
  var textElement = null;
  
  // First, try to find a code element (for command tabs)
  var codeElement = element.querySelector('code');
  if (codeElement) {
    textElement = codeElement;
  } else {
    // Fallback: look for .copy-text (for path tabs)
    var copyTextElement = element.querySelector('.copy-text');
    if (copyTextElement) {
      // If it's a div, look for code inside it
      if (copyTextElement.tagName === 'DIV') {
        var codeInside = copyTextElement.querySelector('code');
        textElement = codeInside || copyTextElement;
      } else {
        textElement = copyTextElement;
      }
    } else {
      // Last resort: try pre element
      textElement = element.querySelector('pre');
    }
  }
  
  if (!textElement) return;
  
  // Get only the text content, not any HTML
  var textToCopy = textElement.textContent || textElement.innerText || '';
  
  // Clean up any extra whitespace but preserve line breaks
  textToCopy = textToCopy.trim();
  
  var textarea = document.createElement('textarea');
  textarea.value = textToCopy;
  document.body.appendChild(textarea);
  textarea.select();
  document.execCommand('copy');
  document.body.removeChild(textarea);
  
  var button = element.querySelector('.copy-button');
  if (!button) return;
  var originalText = button.textContent;
  button.textContent = 'Copied!';
  button.style.backgroundColor = '#28a745';
  setTimeout(function() {
    button.textContent = originalText;
    button.style.backgroundColor = 'rgb(108, 110, 220)';
  }, 1000);
}
</script>


